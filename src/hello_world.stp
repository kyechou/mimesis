# Print message to the S2E log.
# This is a SystemTap function that can be called from SystemTap code.
function s2e_message(message:string) %{
    __asm__ __volatile__(
            ".byte 0x0f, 0x3f\n"
            ".byte 0x00, 0x10, 0x00, 0x00\n"
            ".byte 0x00, 0x00, 0x00, 0x00\n"
            : : "a" (THIS->l_message));
%}

probe vfs.read {
    log("[log] Hello, world!")
    println("[println] Hello, world!")
    s2e_message("[s2e_message] Hello, world!\n")
}
